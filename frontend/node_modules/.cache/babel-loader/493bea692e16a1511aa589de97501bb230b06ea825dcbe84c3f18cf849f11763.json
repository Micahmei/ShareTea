{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Cart=()=>{const[cart,setCart]=useState([]);const navigate=useNavigate();useEffect(()=>{const storedCart=JSON.parse(localStorage.getItem(\"cart\"))||[];console.log(\"üì¶ Current Cart from localStorage:\",storedCart);setCart(storedCart);},[]);const removeItem=index=>{const updated=[...cart];updated.splice(index,1);setCart(updated);localStorage.setItem(\"cart\",JSON.stringify(updated));};const submitOrder=async()=>{const customerName=prompt(\"Enter your name:\");const userId=prompt(\"Enter your user ID:\");const paymentMethod=\"Cash\";if(!customerName||!userId||cart.length===0){alert(\"‚ùå Missing customer name, user ID, or cart is empty.\");return;}const items=cart.map(item=>({itemid:Number(item.itemid),price:Number(item.price),customization:item.customization||\"\"}));const payload={customerName,userId:parseInt(userId),items,paymentMethod};console.log(\"üì§ Submitting payload to backend:\",payload);try{const res=await axios.post(\"http://localhost:5050/api/orders\",payload);console.log(\"‚úÖ Server response:\",res.data);if(res.data.success){const total=items.reduce((sum,i)=>sum+i.price,0);setCart([]);localStorage.removeItem(\"cart\");navigate(\"/payment\",{state:{total}});}else{throw new Error(res.data.message||\"Order failed\");}}catch(err){console.error(\"‚ùå Failed to submit order:\",err);alert(\"‚ùå Failed to submit order. Check the console and server.\");}};const goBack=()=>{navigate(-1);};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 bg-gray-50 min-h-screen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-green-700\",children:\"\\uD83D\\uDED2 Your Cart\"}),/*#__PURE__*/_jsx(\"button\",{onClick:goBack,className:\"bg-gray-300 hover:bg-gray-400 text-black font-semibold px-4 py-2 rounded\",children:\"\\uD83D\\uDD19 Back\"})]}),cart.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-lg\",children:\"Your cart is empty.\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-4\",children:cart.map((item,index)=>/*#__PURE__*/_jsx(\"li\",{className:\"bg-white shadow p-4 rounded border border-gray-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-lg text-gray-800\",children:item.itemname}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"$\",parseFloat(item.price).toFixed(2)]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 italic\",children:item.customization})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeItem(index),className:\"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded\",children:\"\\u274C Remove\"})]})},index))}),/*#__PURE__*/_jsx(\"button\",{onClick:submitOrder,className:\"mt-6 bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded\",children:\"\\u2705 Submit Order\"})]})]});};export default Cart;","map":{"version":3,"names":["React","useEffect","useState","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","cart","setCart","navigate","storedCart","JSON","parse","localStorage","getItem","console","log","removeItem","index","updated","splice","setItem","stringify","submitOrder","customerName","prompt","userId","paymentMethod","length","alert","items","map","item","itemid","Number","price","customization","payload","parseInt","res","post","data","success","total","reduce","sum","i","state","Error","message","err","error","goBack","className","children","onClick","itemname","parseFloat","toFixed"],"sources":["/Users/faqiangmei/Desktop/react-fix-test/frontend/src/components/Cart.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Cart = () => {\n  const [cart, setCart] = useState([]);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const storedCart = JSON.parse(localStorage.getItem(\"cart\")) || [];\n    console.log(\"üì¶ Current Cart from localStorage:\", storedCart);\n    setCart(storedCart);\n  }, []);\n\n  const removeItem = (index) => {\n    const updated = [...cart];\n    updated.splice(index, 1);\n    setCart(updated);\n    localStorage.setItem(\"cart\", JSON.stringify(updated));\n  };\n\n  const submitOrder = async () => {\n    const customerName = prompt(\"Enter your name:\");\n    const userId = prompt(\"Enter your user ID:\");\n    const paymentMethod = \"Cash\";\n\n    if (!customerName || !userId || cart.length === 0) {\n      alert(\"‚ùå Missing customer name, user ID, or cart is empty.\");\n      return;\n    }\n\n    const items = cart.map((item) => ({\n      itemid: Number(item.itemid),\n      price: Number(item.price),\n      customization: item.customization || \"\",\n    }));\n\n    const payload = {\n      customerName,\n      userId: parseInt(userId),\n      items,\n      paymentMethod,\n    };\n\n    console.log(\"üì§ Submitting payload to backend:\", payload);\n\n    try {\n      const res = await axios.post(\"http://localhost:5050/api/orders\", payload);\n      console.log(\"‚úÖ Server response:\", res.data);\n      if (res.data.success) {\n        const total = items.reduce((sum, i) => sum + i.price, 0);\n        setCart([]);\n        localStorage.removeItem(\"cart\");\n        navigate(\"/payment\", { state: { total } });\n      } else {\n        throw new Error(res.data.message || \"Order failed\");\n      }\n    } catch (err) {\n      console.error(\"‚ùå Failed to submit order:\", err);\n      alert(\"‚ùå Failed to submit order. Check the console and server.\");\n    }\n  };\n\n  const goBack = () => {\n    navigate(-1);\n  };\n\n  return (\n    <div className=\"p-6 bg-gray-50 min-h-screen\">\n      <div className=\"flex justify-between items-center mb-4\">\n        <h2 className=\"text-3xl font-bold text-green-700\">üõí Your Cart</h2>\n        <button\n          onClick={goBack}\n          className=\"bg-gray-300 hover:bg-gray-400 text-black font-semibold px-4 py-2 rounded\"\n        >\n          üîô Back\n        </button>\n      </div>\n\n      {cart.length === 0 ? (\n        <p className=\"text-gray-500 text-lg\">Your cart is empty.</p>\n      ) : (\n        <>\n          <ul className=\"space-y-4\">\n            {cart.map((item, index) => (\n              <li\n                key={index}\n                className=\"bg-white shadow p-4 rounded border border-gray-100\"\n              >\n                <div className=\"flex justify-between items-center\">\n                  <div>\n                    <p className=\"font-bold text-lg text-gray-800\">{item.itemname}</p>\n                    <p className=\"text-sm text-gray-600\">${parseFloat(item.price).toFixed(2)}</p>\n                    <p className=\"text-sm text-gray-500 italic\">{item.customization}</p>\n                  </div>\n                  <button\n                    onClick={() => removeItem(index)}\n                    className=\"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded\"\n                  >\n                    ‚ùå Remove\n                  </button>\n                </div>\n              </li>\n            ))}\n          </ul>\n\n          <button\n            onClick={submitOrder}\n            className=\"mt-6 bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded\"\n          >\n            ‚úÖ Submit Order\n          </button>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default Cart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}