{"ast":null,"code":"const express = require('express');\nconst app = express();\nconst pool = require('./db'); // ÂÅáËÆæ‰Ω†Âú®‰∏Ä‰∏™ db.js Êñá‰ª∂‰∏≠ËÆæÁΩÆ‰∫ÜÊï∞ÊçÆÂ∫ìËøûÊé•\nconst cors = require('cors');\napp.use(cors());\napp.use(express.json()); // ‰ΩøÊúçÂä°Âô®ËÉΩÂ§üÂ§ÑÁêÜ JSON Êï∞ÊçÆ\n\n// Ëé∑ÂèñÊâÄÊúâÂ∫ìÂ≠òËÆ∞ÂΩïÔºàÂåÖÂê´ menuitem ÂêçÂ≠óÔºâ\napp.get('/api/inventory', async (req, res) => {\n  try {\n    const result = await pool.query(`\n      SELECT \n        i.inventoryid,import React, { useEffect, useState } from \"react\";\n        import axios from \"axios\";\n        import { useNavigate } from \"react-router-dom\";\n        \n        const Inventory = () => {\n          const [ingredients, setIngredients] = useState([]);\n          const [newIngredient, setNewIngredient] = useState({ menuitemid: \"\", quantity: \"\" });\n          const navigate = useNavigate();\n        \n          useEffect(() => {\n            fetchInventory();\n          }, []);\n        \n          const fetchInventory = async () => {\n            try {\n              const res = await axios.get(\"http://localhost:5050/api/inventory\");\n              setIngredients(res.data);\n            } catch (err) {\n              console.error(\"Error fetching inventory:\", err);\n            }\n          };\n        \n          const handleAdd = async () => {\n            if (!newIngredient.menuitemid || !newIngredient.quantity) {\n              alert(\"Please enter both item ID and quantity.\");\n              return;\n            }\n            try {\n              await axios.post(\"http://localhost:5050/api/inventory/add\", newIngredient);\n              setNewIngredient({ menuitemid: \"\", quantity: \"\" });\n              fetchInventory();\n            } catch (err) {\n              console.error(\"Error adding inventory:\", err);\n            }\n          };\n        \n          const handleDelete = async (inventoryid) => {\n            try {\n              await axios.delete(\"http://localhost:5050/api/inventory/delete\", {\n                data: { inventoryid },\n              });\n              fetchInventory();\n            } catch (err) {\n              console.error(\"Error deleting inventory:\", err);\n            }\n          };\n        \n          return (\n            <div style={{ padding: \"20px\" }}>\n              <h2>üì¶ Inventory Management</h2>\n        \n              <div>\n                <input\n                  type=\"text\"\n                  placeholder=\"Menu Item ID\"\n                  value={newIngredient.menuitemid}\n                  onChange={(e) => setNewIngredient({ ...newIngredient, menuitemid: e.target.value })}\n                />\n                <input\n                  type=\"number\"\n                  placeholder=\"Quantity\"\n                  value={newIngredient.quantity}\n                  onChange={(e) => setNewIngredient({ ...newIngredient, quantity: e.target.value })}\n                />\n                <button onClick={handleAdd}>‚ûï Add Ingredient</button>\n              </div>\n        \n              <h3>üìã Current Inventory</h3>\n              {ingredients.length === 0 ? (\n                <p>No items available.</p>\n              ) : (\n                <table border=\"1\" cellPadding=\"8\" style={{ borderCollapse: \"collapse\", width: \"100%\" }}>\n                  <thead style={{ backgroundColor: \"#f2f2f2\" }}>\n                    <tr>\n                      <th>ID</th>\n                      <th>Item Name</th>\n                      <th>Quantity</th>\n                      <th>Restock Date</th>\n                      <th>Last Updated</th>\n                      <th>Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {ingredients.map((item) => (\n                      <tr key={item.inventoryid}>\n                        <td>{item.inventoryid}</td>\n                        <td>{item.itemname}</td>\n                        <td>{item.quantity}</td>\n                        <td>{new Date(item.restockdate).toLocaleDateString()}</td>\n                        <td>{new Date(item.lastupdated).toLocaleDateString()}</td>\n                        <td>\n                          <button onClick={() => handleDelete(item.inventoryid)}>‚ùå Delete</button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              )}\n        \n              <button style={{ marginTop: \"20px\" }} onClick={() => navigate(\"/\")}>‚¨ÖÔ∏è Back</button>\n            </div>\n          );\n        };\n        \n        export default Inventory;\n        \n        i.quantity,\n        i.menuitemid,\n        m.itemname,\n        i.timestamp,\n        i.restockdate,\n        i.lastupdated\n      FROM inventory i\n      JOIN menuitem m ON i.menuitemid = m.itemid\n      ORDER BY i.inventoryid;\n    `);\n    res.json(result.rows);\n  } catch (err) {\n    console.error('Error fetching inventory:', err);\n    res.status(500).json({\n      error: 'Failed to fetch inventory'\n    });\n  }\n});\n\n// Ê∑ªÂä†Â∫ìÂ≠òËÆ∞ÂΩï\napp.post('/api/inventory/add', async (req, res) => {\n  const {\n    menuitemid,\n    quantity\n  } = req.body;\n  if (!menuitemid || !quantity) {\n    return res.status(400).json({\n      error: 'Missing fields'\n    });\n  }\n  try {\n    const now = new Date();\n    await pool.query(`\n      INSERT INTO inventory (timestamp, menuitemid, quantity, restockdate, lastupdated)\n      VALUES ($1, $2, $3, $1, $1)\n    `, [now, menuitemid, quantity]);\n    res.json({\n      success: true\n    });\n  } catch (err) {\n    console.error('Error adding inventory:', err);\n    res.status(500).json({\n      error: 'Failed to add inventory'\n    });\n  }\n});\n\n// Âà†Èô§Â∫ìÂ≠òËÆ∞ÂΩï\napp.delete('/api/inventory/delete', async (req, res) => {\n  const {\n    inventoryid\n  } = req.body;\n  if (!inventoryid) {\n    return res.status(400).json({\n      error: 'Missing inventory ID'\n    });\n  }\n  try {\n    await pool.query('DELETE FROM inventory WHERE inventoryid = $1', [inventoryid]);\n    res.json({\n      success: true\n    });\n  } catch (err) {\n    console.error('Error deleting inventory:', err);\n    res.status(500).json({\n      error: 'Failed to delete inventory'\n    });\n  }\n});\n\n// ÂêØÂä®ÊúçÂä°Âô®\napp.listen(5050, () => {\n  console.log('Server running on port 5050');\n});","map":{"version":3,"names":["express","require","app","pool","cors","use","json","get","req","res","result","query","rows","err","console","error","status","post","menuitemid","quantity","body","now","Date","success","delete","inventoryid","listen","log"],"sources":["/Users/faqiangmei/Desktop/react-fix-test/frontend/src/components/Inventory.js"],"sourcesContent":["const express = require('express');\nconst app = express();\nconst pool = require('./db');  // ÂÅáËÆæ‰Ω†Âú®‰∏Ä‰∏™ db.js Êñá‰ª∂‰∏≠ËÆæÁΩÆ‰∫ÜÊï∞ÊçÆÂ∫ìËøûÊé•\nconst cors = require('cors');\napp.use(cors());\napp.use(express.json()); // ‰ΩøÊúçÂä°Âô®ËÉΩÂ§üÂ§ÑÁêÜ JSON Êï∞ÊçÆ\n\n// Ëé∑ÂèñÊâÄÊúâÂ∫ìÂ≠òËÆ∞ÂΩïÔºàÂåÖÂê´ menuitem ÂêçÂ≠óÔºâ\napp.get('/api/inventory', async (req, res) => {\n  try {\n    const result = await pool.query(`\n      SELECT \n        i.inventoryid,import React, { useEffect, useState } from \"react\";\n        import axios from \"axios\";\n        import { useNavigate } from \"react-router-dom\";\n        \n        const Inventory = () => {\n          const [ingredients, setIngredients] = useState([]);\n          const [newIngredient, setNewIngredient] = useState({ menuitemid: \"\", quantity: \"\" });\n          const navigate = useNavigate();\n        \n          useEffect(() => {\n            fetchInventory();\n          }, []);\n        \n          const fetchInventory = async () => {\n            try {\n              const res = await axios.get(\"http://localhost:5050/api/inventory\");\n              setIngredients(res.data);\n            } catch (err) {\n              console.error(\"Error fetching inventory:\", err);\n            }\n          };\n        \n          const handleAdd = async () => {\n            if (!newIngredient.menuitemid || !newIngredient.quantity) {\n              alert(\"Please enter both item ID and quantity.\");\n              return;\n            }\n            try {\n              await axios.post(\"http://localhost:5050/api/inventory/add\", newIngredient);\n              setNewIngredient({ menuitemid: \"\", quantity: \"\" });\n              fetchInventory();\n            } catch (err) {\n              console.error(\"Error adding inventory:\", err);\n            }\n          };\n        \n          const handleDelete = async (inventoryid) => {\n            try {\n              await axios.delete(\"http://localhost:5050/api/inventory/delete\", {\n                data: { inventoryid },\n              });\n              fetchInventory();\n            } catch (err) {\n              console.error(\"Error deleting inventory:\", err);\n            }\n          };\n        \n          return (\n            <div style={{ padding: \"20px\" }}>\n              <h2>üì¶ Inventory Management</h2>\n        \n              <div>\n                <input\n                  type=\"text\"\n                  placeholder=\"Menu Item ID\"\n                  value={newIngredient.menuitemid}\n                  onChange={(e) => setNewIngredient({ ...newIngredient, menuitemid: e.target.value })}\n                />\n                <input\n                  type=\"number\"\n                  placeholder=\"Quantity\"\n                  value={newIngredient.quantity}\n                  onChange={(e) => setNewIngredient({ ...newIngredient, quantity: e.target.value })}\n                />\n                <button onClick={handleAdd}>‚ûï Add Ingredient</button>\n              </div>\n        \n              <h3>üìã Current Inventory</h3>\n              {ingredients.length === 0 ? (\n                <p>No items available.</p>\n              ) : (\n                <table border=\"1\" cellPadding=\"8\" style={{ borderCollapse: \"collapse\", width: \"100%\" }}>\n                  <thead style={{ backgroundColor: \"#f2f2f2\" }}>\n                    <tr>\n                      <th>ID</th>\n                      <th>Item Name</th>\n                      <th>Quantity</th>\n                      <th>Restock Date</th>\n                      <th>Last Updated</th>\n                      <th>Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {ingredients.map((item) => (\n                      <tr key={item.inventoryid}>\n                        <td>{item.inventoryid}</td>\n                        <td>{item.itemname}</td>\n                        <td>{item.quantity}</td>\n                        <td>{new Date(item.restockdate).toLocaleDateString()}</td>\n                        <td>{new Date(item.lastupdated).toLocaleDateString()}</td>\n                        <td>\n                          <button onClick={() => handleDelete(item.inventoryid)}>‚ùå Delete</button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              )}\n        \n              <button style={{ marginTop: \"20px\" }} onClick={() => navigate(\"/\")}>‚¨ÖÔ∏è Back</button>\n            </div>\n          );\n        };\n        \n        export default Inventory;\n        \n        i.quantity,\n        i.menuitemid,\n        m.itemname,\n        i.timestamp,\n        i.restockdate,\n        i.lastupdated\n      FROM inventory i\n      JOIN menuitem m ON i.menuitemid = m.itemid\n      ORDER BY i.inventoryid;\n    `);\n    res.json(result.rows);\n  } catch (err) {\n    console.error('Error fetching inventory:', err);\n    res.status(500).json({ error: 'Failed to fetch inventory' });\n  }\n});\n\n// Ê∑ªÂä†Â∫ìÂ≠òËÆ∞ÂΩï\napp.post('/api/inventory/add', async (req, res) => {\n  const { menuitemid, quantity } = req.body;\n\n  if (!menuitemid || !quantity) {\n    return res.status(400).json({ error: 'Missing fields' });\n  }\n\n  try {\n    const now = new Date();\n    await pool.query(`\n      INSERT INTO inventory (timestamp, menuitemid, quantity, restockdate, lastupdated)\n      VALUES ($1, $2, $3, $1, $1)\n    `, [now, menuitemid, quantity]);\n\n    res.json({ success: true });\n  } catch (err) {\n    console.error('Error adding inventory:', err);\n    res.status(500).json({ error: 'Failed to add inventory' });\n  }\n});\n\n// Âà†Èô§Â∫ìÂ≠òËÆ∞ÂΩï\napp.delete('/api/inventory/delete', async (req, res) => {\n  const { inventoryid } = req.body;\n\n  if (!inventoryid) {\n    return res.status(400).json({ error: 'Missing inventory ID' });\n  }\n\n  try {\n    await pool.query('DELETE FROM inventory WHERE inventoryid = $1', [inventoryid]);\n    res.json({ success: true });\n  } catch (err) {\n    console.error('Error deleting inventory:', err);\n    res.status(500).json({ error: 'Failed to delete inventory' });\n  }\n});\n\n// ÂêØÂä®ÊúçÂä°Âô®\napp.listen(5050, () => {\n  console.log('Server running on port 5050');\n});\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,GAAG,GAAGF,OAAO,CAAC,CAAC;AACrB,MAAMG,IAAI,GAAGF,OAAO,CAAC,MAAM,CAAC,CAAC,CAAE;AAC/B,MAAMG,IAAI,GAAGH,OAAO,CAAC,MAAM,CAAC;AAC5BC,GAAG,CAACG,GAAG,CAACD,IAAI,CAAC,CAAC,CAAC;AACfF,GAAG,CAACG,GAAG,CAACL,OAAO,CAACM,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;;AAEzB;AACAJ,GAAG,CAACK,GAAG,CAAC,gBAAgB,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAC5C,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMP,IAAI,CAACQ,KAAK,CAAC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,CAAC;IACFF,GAAG,CAACH,IAAI,CAACI,MAAM,CAACE,IAAI,CAAC;EACvB,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;IAC/CJ,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACV,IAAI,CAAC;MAAES,KAAK,EAAE;IAA4B,CAAC,CAAC;EAC9D;AACF,CAAC,CAAC;;AAEF;AACAb,GAAG,CAACe,IAAI,CAAC,oBAAoB,EAAE,OAAOT,GAAG,EAAEC,GAAG,KAAK;EACjD,MAAM;IAAES,UAAU;IAAEC;EAAS,CAAC,GAAGX,GAAG,CAACY,IAAI;EAEzC,IAAI,CAACF,UAAU,IAAI,CAACC,QAAQ,EAAE;IAC5B,OAAOV,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACV,IAAI,CAAC;MAAES,KAAK,EAAE;IAAiB,CAAC,CAAC;EAC1D;EAEA,IAAI;IACF,MAAMM,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC;IACtB,MAAMnB,IAAI,CAACQ,KAAK,CAAC;AACrB;AACA;AACA,KAAK,EAAE,CAACU,GAAG,EAAEH,UAAU,EAAEC,QAAQ,CAAC,CAAC;IAE/BV,GAAG,CAACH,IAAI,CAAC;MAAEiB,OAAO,EAAE;IAAK,CAAC,CAAC;EAC7B,CAAC,CAAC,OAAOV,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC;IAC7CJ,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACV,IAAI,CAAC;MAAES,KAAK,EAAE;IAA0B,CAAC,CAAC;EAC5D;AACF,CAAC,CAAC;;AAEF;AACAb,GAAG,CAACsB,MAAM,CAAC,uBAAuB,EAAE,OAAOhB,GAAG,EAAEC,GAAG,KAAK;EACtD,MAAM;IAAEgB;EAAY,CAAC,GAAGjB,GAAG,CAACY,IAAI;EAEhC,IAAI,CAACK,WAAW,EAAE;IAChB,OAAOhB,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACV,IAAI,CAAC;MAAES,KAAK,EAAE;IAAuB,CAAC,CAAC;EAChE;EAEA,IAAI;IACF,MAAMZ,IAAI,CAACQ,KAAK,CAAC,8CAA8C,EAAE,CAACc,WAAW,CAAC,CAAC;IAC/EhB,GAAG,CAACH,IAAI,CAAC;MAAEiB,OAAO,EAAE;IAAK,CAAC,CAAC;EAC7B,CAAC,CAAC,OAAOV,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;IAC/CJ,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACV,IAAI,CAAC;MAAES,KAAK,EAAE;IAA6B,CAAC,CAAC;EAC/D;AACF,CAAC,CAAC;;AAEF;AACAb,GAAG,CAACwB,MAAM,CAAC,IAAI,EAAE,MAAM;EACrBZ,OAAO,CAACa,GAAG,CAAC,6BAA6B,CAAC;AAC5C,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}